{% extends "base-html.html" %}

{% block title %}{{ contentData.title }}{% endblock %}

{% block javascript %}
<link rel="stylesheet" href="{{ url_for('static', filename='agent-playground/workspace.css') }}" />
<script type="module" src="{{ url_for('static', filename='agent-playground/workspace.js') }}"></script>
{% endblock %}

{% block content %}
<div id="ap-workspace" data-api-base="/api/agent-playground">
    <section id="ap-toolbar">
        <div class="ap-toolbar-group">
            <label for="ap-run-mode">Run Mode</label>
            <select id="ap-run-mode"></select>
            <label for="ap-run-history">Run History</label>
            <select id="ap-run-history"></select>
            <button id="ap-start-btn" type="button">Start Run</button>
            <button id="ap-refresh-btn" type="button">Refresh</button>
        </div>
        <div class="ap-toolbar-group" id="ap-pane-controls">
            <span class="ap-toolbar-label">Panes</span>
        </div>
        <div class="ap-toolbar-group">
            <label for="ap-layout-preset">Layout</label>
            <select id="ap-layout-preset">
                <option value="balanced">Balanced</option>
                <option value="chat_focus">Chat Focus</option>
                <option value="analysis_focus">Analysis Focus</option>
            </select>
            <button id="ap-layout-reset" type="button">Reset Panes</button>
        </div>
        <div class="ap-toolbar-group">
            <span id="ap-run-status">Idle</span>
            <span id="ap-run-meta">Run: <span id="ap-run-id">-</span></span>
            <span id="ap-run-mode-meta">Mode: <span id="ap-run-mode-active">-</span></span>
        </div>
        <div class="ap-toolbar-group" id="ap-metrics-row">
            <span class="ap-metric-chip">Total <strong id="ap-metric-total">0</strong></span>
            <span class="ap-metric-chip">Running <strong id="ap-metric-running">0</strong></span>
            <span class="ap-metric-chip">Avg(s) <strong id="ap-metric-avg">0</strong></span>
            <span class="ap-metric-chip">Completed <strong id="ap-metric-completed">0</strong></span>
            <span class="ap-metric-chip">Failed <strong id="ap-metric-failed">0</strong></span>
        </div>
    </section>

    <section class="ap-pane" id="ap-schema-pane">
        <header class="ap-pane-header">
            <div class="ap-pane-title">Schema Driven Config</div>
            <div class="ap-pane-header-actions">
                <button class="ap-pane-collapse-btn" type="button" data-pane-collapse="schema" aria-expanded="true">Collapse</button>
            </div>
        </header>
        <div class="ap-pane-body">
            <div class="ap-toolbar-group">
                <label for="ap-schema-capability">Capability</label>
                <select id="ap-schema-capability"></select>
            </div>
            <form id="ap-schema-form"></form>
        </div>
    </section>

    <section id="ap-grid">
        <article class="ap-pane" id="ap-chat-pane">
            <header class="ap-pane-header">
                <div class="ap-pane-title">Chat / Run</div>
                <div class="ap-pane-header-actions">
                    <button class="ap-pane-collapse-btn" type="button" data-pane-collapse="chat" aria-expanded="true">Collapse</button>
                </div>
            </header>
            <div class="ap-pane-body" data-pane="chat"></div>
        </article>

        <article class="ap-pane" id="ap-trace-pane">
            <header class="ap-pane-header">
                <div class="ap-pane-title">Trace / Steps</div>
                <div class="ap-pane-header-actions">
                    <button class="ap-pane-collapse-btn" type="button" data-pane-collapse="trace" aria-expanded="true">Collapse</button>
                </div>
            </header>
            <div class="ap-pane-body" data-pane="trace"></div>
        </article>

        <article class="ap-pane" id="ap-state-pane">
            <header class="ap-pane-header">
                <div class="ap-pane-title">State</div>
                <div class="ap-pane-header-actions">
                    <button class="ap-pane-collapse-btn" type="button" data-pane-collapse="state" aria-expanded="true">Collapse</button>
                </div>
            </header>
            <div class="ap-pane-body" data-pane="state"></div>
        </article>

        <article class="ap-pane" id="ap-artifacts-pane">
            <header class="ap-pane-header">
                <div class="ap-pane-title">Artifacts</div>
                <div class="ap-pane-header-actions">
                    <button class="ap-pane-collapse-btn" type="button" data-pane-collapse="artifacts" aria-expanded="true">Collapse</button>
                </div>
            </header>
            <div class="ap-pane-body" data-pane="artifacts"></div>
        </article>

        <article class="ap-pane" id="ap-inspector-pane">
            <header class="ap-pane-header">
                <div class="ap-pane-title">Inspector</div>
                <div class="ap-pane-header-actions">
                    <button class="ap-pane-collapse-btn" type="button" data-pane-collapse="inspector" aria-expanded="true">Collapse</button>
                </div>
            </header>
            <div class="ap-pane-body" data-pane="inspector"></div>
        </article>
    </section>
</div>
{% endblock %}

{% block footer %}
<div id="ap-composer">
    <textarea id="ap-input" placeholder="Enter a user prompt. For batch mode, add one input per line. For workflow mode, define stage intent in natural language."></textarea>
    <div id="ap-composer-actions">
        <button id="ap-run-btn" type="button">Run</button>
        <button id="ap-cancel-btn" type="button">Cancel</button>
        <button id="ap-replay-btn" type="button">Replay</button>
        <button id="ap-resume-btn" type="button">Resume</button>
    </div>
</div>
{% endblock %}
